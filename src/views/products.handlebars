<h1>Productos (paginados)</h1>

<!-- Form filtros -->
<form method="get" action="/products">
  <input type="text" name="query" placeholder="category o status (true/false)" value="{{query.query}}">
  <select name="sort">
    <option value="">Sin ordenar</option>
    <option value="asc" {{#if (eq query.sort "asc")}}selected{{/if}}>Precio asc</option>
    <option value="desc" {{#if (eq query.sort "desc")}}selected{{/if}}>Precio desc</option>
  </select>
  <input type="number" name="limit" placeholder="limit" value="{{query.limit}}">
  <button type="submit">Filtrar</button>
</form>

<ul>
  {{#each products}}
    <li>
      <a href="/products/{{_id}}"><strong>{{title}}</strong></a> — ${{price}}<br>
      {{description}}<br>
      Código: {{code}} — Stock: {{stock}} — Categoria: {{category}}
      <!-- botón agregar al carrito vía POST /api/carts/:cid/product/:pid (en cliente se puede hacer por fetch) -->
      <form style="display:inline" method="post" action="/api/carts/{{../cartId}}/product/{{_id}}">
        <button type="submit">Agregar al carrito</button>
      </form>
    </li>
  {{/each}}
</ul>

<nav>
  {{#if pagination.hasPrevPage}}
    <a href="?page={{subtract pagination.page 1}}">Anterior</a>
  {{/if}}
  Página {{pagination.page}} de {{pagination.totalPages}}
  {{#if pagination.hasNextPage}}
    <a href="?page={{add pagination.page 1}}">Siguiente</a>
  {{/if}}
</nav>
